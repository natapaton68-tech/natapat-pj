<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-neutral-900 to-neutral-800 min-h-screen">
    <!-- Navigation -->
    <nav class="bg-gradient-to-r from-red-600 to-red-900 shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <h1 class="text-white text-2xl font-bold">üìö ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1>
                <div class="flex gap-4">
                    <button onclick="switchTab('students')" class="tab-btn active px-4 py-2 rounded-lg text-white font-semibold hover:bg-red-700 transition">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
                    <button onclick="switchTab('attendance')" class="tab-btn px-4 py-2 rounded-lg text-white font-semibold hover:bg-red-700 transition">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Students Section -->
        <div id="students-section" class="tab-content">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Add Student Form -->
                <div class="lg:col-span-1">
                    <div class="bg-gradient-to-br from-neutral-950 to-neutral-900 rounded-3xl shadow-2xl p-8 border-2 border-red-600">
                        <h2 class="text-white text-2xl font-bold mb-6 text-center">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-red-500 font-bold text-sm uppercase mb-2">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                                <input type="text" id="studentName" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠" class="w-full px-4 py-2 rounded-lg bg-neutral-800 text-white border border-red-600 focus:outline-none focus:border-red-400">
                            </div>

                            <div>
                                <label class="block text-red-500 font-bold text-sm uppercase mb-2">‡∏´‡πâ‡∏≠‡∏á</label>
                                <input type="text" id="studentRoom" placeholder="‡πÄ‡∏ä‡πà‡∏ô 1/1" class="w-full px-4 py-2 rounded-lg bg-neutral-800 text-white border border-red-600 focus:outline-none focus:border-red-400">
                            </div>

                            <div>
                                <label class="block text-red-500 font-bold text-sm uppercase mb-2">‡∏ß‡∏¥‡∏ä‡∏≤</label>
                                <input type="text" id="studentSubject" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå" class="w-full px-4 py-2 rounded-lg bg-neutral-800 text-white border border-red-600 focus:outline-none focus:border-red-400">
                            </div>

                            <div>
                                <label class="block text-red-500 font-bold text-sm uppercase mb-2">Face Data (‡∏´‡∏≤‡∏Å‡∏°‡∏µ)</label>
                                <input type="text" id="studentFaceData" placeholder="Optional" class="w-full px-4 py-2 rounded-lg bg-neutral-800 text-white border border-red-600 focus:outline-none focus:border-red-400">
                            </div>

                            <button onclick="addStudent()" class="w-full bg-gradient-to-br from-red-600 to-red-900 text-white font-bold py-3 rounded-lg hover:from-red-700 hover:to-red-950 transition shadow-lg">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
                        </div>
                    </div>
                </div>

                <!-- Students List -->
                <div class="lg:col-span-2">
                    <div class="bg-gradient-to-br from-neutral-950 to-neutral-900 rounded-3xl shadow-2xl p-8 border-2 border-red-600">
                        <h2 class="text-white text-2xl font-bold mb-6">üë• ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
                        
                        <div id="studentsList" class="space-y-3 max-h-96 overflow-y-auto">
                            <p class="text-gray-400 text-center py-8">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Attendance Section -->
        <div id="attendance-section" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Record Attendance Form -->
                <div class="lg:col-span-1">
                    <div class="bg-gradient-to-br from-neutral-950 to-neutral-900 rounded-3xl shadow-2xl p-8 border-2 border-red-600">
                        <h2 class="text-white text-2xl font-bold mb-6 text-center">‚úèÔ∏è ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-red-500 font-bold text-sm uppercase mb-2">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                                <input type="text" id="attendanceName" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠" class="w-full px-4 py-2 rounded-lg bg-neutral-800 text-white border border-red-600 focus:outline-none focus:border-red-400">
                            </div>

                            <div>
                                <label class="block text-red-500 font-bold text-sm uppercase mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                                <input type="date" id="attendanceDate" class="w-full px-4 py-2 rounded-lg bg-neutral-800 text-white border border-red-600 focus:outline-none focus:border-red-400">
                            </div>

                            <div>
                                <label class="block text-red-500 font-bold text-sm uppercase mb-2">‡πÄ‡∏ß‡∏•‡∏≤</label>
                                <input type="time" id="attendanceTime" class="w-full px-4 py-2 rounded-lg bg-neutral-800 text-white border border-red-600 focus:outline-none focus:border-red-400">
                            </div>

                            <button onclick="recordAttendance()" class="w-full bg-gradient-to-br from-red-600 to-red-900 text-white font-bold py-3 rounded-lg hover:from-red-700 hover:to-red-950 transition shadow-lg">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
                        </div>
                    </div>
                </div>

                <!-- Attendance Records -->
                <div class="lg:col-span-2">
                    <div class="bg-gradient-to-br from-neutral-950 to-neutral-900 rounded-3xl shadow-2xl p-8 border-2 border-red-600">
                        <h2 class="text-white text-2xl font-bold mb-6">üìã ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
                        
                        <div id="attendanceList" class="space-y-3 max-h-96 overflow-y-auto">
                            <p class="text-gray-400 text-center py-8">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- API Settings -->
        <div class="mt-12 bg-gradient-to-br from-neutral-950 to-neutral-900 rounded-3xl shadow-2xl p-8 border-2 border-red-600">
            <h2 class="text-white text-xl font-bold mb-4">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ API</h2>
            <div class="space-y-4">
                <div>
                    <label class="block text-red-500 font-bold text-sm uppercase mb-2">Sheet ID</label>
                    <input type="text" id="sheetId" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Google Sheet ID" class="w-full px-4 py-2 rounded-lg bg-neutral-800 text-white border border-red-600 focus:outline-none focus:border-red-400">
                </div>
                <div>
                    <label class="block text-red-500 font-bold text-sm uppercase mb-2">API URL</label>
                    <input type="text" id="apiUrl" placeholder="URL ‡∏Ç‡∏≠‡∏á Google Apps Script" class="w-full px-4 py-2 rounded-lg bg-neutral-800 text-white border border-red-600 focus:outline-none focus:border-red-400">
                </div>
                <button onclick="loadStudents()" class="bg-gradient-to-br from-red-600 to-red-900 text-white font-bold py-2 px-6 rounded-lg hover:from-red-700 hover:to-red-950 transition">‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            </div>
        </div>
    </div>

    <script>
        // Local data storage
        let students = [];
        let attendance = [];

        // Switch between tabs
        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(tab + '-section').classList.remove('hidden');
            
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        // Add student
        function addStudent() {
            const name = document.getElementById('studentName').value.trim();
            const room = document.getElementById('studentRoom').value.trim();
            const subject = document.getElementById('studentSubject').value.trim();
            const faceData = document.getElementById('studentFaceData').value.trim();

            if (!name || !room || !subject) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
                return;
            }

            const student = {
                name,
                room,
                subject,
                faceData,
                timestamp: new Date().toISOString()
            };

            students.push(student);
            renderStudents();
            
            // Clear form
            document.getElementById('studentName').value = '';
            document.getElementById('studentRoom').value = '';
            document.getElementById('studentSubject').value = '';
            document.getElementById('studentFaceData').value = '';
            
            alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
        }

        // Render students list
        function renderStudents() {
            const list = document.getElementById('studentsList');
            
            if (students.length === 0) {
                list.innerHTML = '<p class="text-gray-400 text-center py-8">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>';
                return;
            }

            list.innerHTML = students.map((student, index) => `
                <div class="bg-neutral-800 p-4 rounded-lg border border-red-600/30 hover:border-red-600 transition">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-red-500 font-bold">${student.name}</p>
                            <p class="text-gray-400 text-sm">‡∏´‡πâ‡∏≠‡∏á: ${student.room} | ‡∏ß‡∏¥‡∏ä‡∏≤: ${student.subject}</p>
                            ${student.faceData ? `<p class="text-gray-500 text-xs mt-1">Face Data: ${student.faceData}</p>` : ''}
                        </div>
                        <button onclick="removeStudent(${index})" class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm">‡∏•‡∏ö</button>
                    </div>
                </div>
            `).join('');
        }

        // Remove student
        function removeStudent(index) {
            if (confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                students.splice(index, 1);
                renderStudents();
            }
        }

        // Record attendance
        function recordAttendance() {
            const name = document.getElementById('attendanceName').value.trim();
            const date = document.getElementById('attendanceDate').value;
            const time = document.getElementById('attendanceTime').value;

            if (!name || !date || !time) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
                return;
            }

            const record = {
                name,
                date,
                time,
                timestamp: new Date().toISOString()
            };

            attendance.push(record);
            renderAttendance();
            
            // Clear form
            document.getElementById('attendanceName').value = '';
            document.getElementById('attendanceDate').value = '';
            document.getElementById('attendanceTime').value = '';
            
            alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
        }

        // Render attendance list
        function renderAttendance() {
            const list = document.getElementById('attendanceList');
            
            if (attendance.length === 0) {
                list.innerHTML = '<p class="text-gray-400 text-center py-8">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>';
                return;
            }

            list.innerHTML = attendance.map((record, index) => `
                <div class="bg-neutral-800 p-4 rounded-lg border border-red-600/30 hover:border-red-600 transition">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-red-500 font-bold">${record.name}</p>
                            <p class="text-gray-400 text-sm">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${record.date} | ‡πÄ‡∏ß‡∏•‡∏≤: ${record.time}</p>
                        </div>
                        <button onclick="removeAttendance(${index})" class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm">‡∏•‡∏ö</button>
                    </div>
                </div>
            `).join('');
        }

        // Remove attendance record
        function removeAttendance(index) {
            if (confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                attendance.splice(index, 1);
                renderAttendance();
            }
        }

        // Load students from API
        async function loadStudents() {
            const sheetId = document.getElementById('sheetId').value.trim();
            const apiUrl = document.getElementById('apiUrl').value.trim();

            if (!sheetId || !apiUrl) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Sheet ID ‡πÅ‡∏•‡∏∞ API URL');
                return;
            }

            try {
                const response = await fetch(`${apiUrl}?action=getStudents&sheetId=${sheetId}`);
                const data = await response.json();

                if (data.success) {
                    students = data.students || [];
                    renderStudents();
                    alert('‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                } else {
                    alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + data.message);
                }
            } catch (error) {
                alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ API: ' + error.message);
            }
        }

        // Set default date to today
        window.addEventListener('load', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('attendanceDate').value = today;
        });
    </script>
</body>
</html>